FROM java:8-jdk

EXPOSE 8080

ENV SPRING_PROFILE prod
ENV TIMETRACK_BACKEND_HOME /opt/timetrack
ENV TIMETRACK_SERVER_JAR backend-server.jar
ENV TIMETRACK_TOOLS_JAR backend-tools.jar

COPY ./backend-server/target/$TIMETRACK_SERVER_JAR $TIMETRACK_BACKEND_HOME/$TIMETRACK_SERVER_JAR
COPY ./backend-tools/target/$TIMETRACK_TOOLS_JAR $TIMETRACK_BACKEND_HOME/$TIMETRACK_TOOLS_JAR

CMD /usr/lib/jvm/java-8-openjdk-amd64/bin/java \
    -jar \
    -Dspring.profiles.active=$SPRING_PROFILE \
    $TIMETRACK_BACKEND_HOME/$TIMETRACK_SERVER_JAR